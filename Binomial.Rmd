---
title: "Untitled"
author: "Joyce Robbins"
date: "3/5/2019"
output: 
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

```{r}
library(tidyverse)
last_flip_colors <- c("#00874F", "#67A9DF")
```


## Visualizing the Binomial Distribution {-}

What is the probability that you'll get an even number of heads if you flip a fair coin 20 times?

My go-to explanations are visual, so it bothered me that the visual for a binomial with n = 20, p = .5 does not clearly make the case that the probability, as you might guess, is .5:

With R:  


```{r}
sum(dbinom(seq(0, 20, 2), 20, .5))
```

Another approach: It is easier to see that the solution must be .5 for an odd number of flips, based on the symmetry of the binomial distribution. Let's start simple and graph the number of ways of getting 0, 1, 2, or 3 heads on 3 flips:
```

```{r}
make_df <- function(n) {
  data.frame(x = 0:n, 
             ways = dbinom(0:n, n, .5)*(2^n), 
             num_heads = ifelse((0:n) %% 2 == 0, "even", "odd"))
}

df3 <- make_df(3)

ggplot(df3, aes(x, ways, fill = num_heads)) + geom_col() +
  ggtitle("Number of ways of getting X heads on 3 flips")
```



Clearly, odd and even are identical, and therefore the probability of either is 1/2.

With 4 flips, it's not quite so obvious that the number of ways to get an even number of heads {0, 2, or 4} is the same as the number of ways of getting an odd number of heads {1 or 3}:


```{r}
df4 <- make_df(4)
ggplot(df4, aes(x, ways, fill = num_heads)) + geom_col() +
  ggtitle("Number of ways of getting X heads on 4 flips")

```


But let's look at it another way. The number of different ways of flipping 4 coins is double the number of ways of flipping 3 coins. The outcomes can be summarized as:

outcomes for 3 flips + "T" --> same number of heads as with 3 flips

outcomes for 3 flips + "H" --> one more heads than with 3 flips 
Graphically we have:

```{r, fig.width = 5}
df4H <- df3 %>% mutate(x = x + 1, last_flip = "H")
df4T <- df3 %>% mutate(last_flip = "T")
df4new <- rbind(df4H, df4T) %>% 
  mutate(last_flip = fct_relevel(last_flip, "T")) 

g <- ggplot(df4new, aes(x, ways, fill = last_flip)) + geom_col() +
  ggtitle("Number of ways of getting X heads on 4 flips",
          sub = "shown as number of ways of getting X heads on 3 flips + 1 more flip") +
  scale_fill_manual(values = last_flip_colors)
```


The green represents the number of ways on getting X heads on 4 flips if the last flip is tails. It is the same as the distribution of getting X heads on 3 flips, since none of the counts increase if the last flip is tails. The blue represents the number of ways of getting X heads on 4 flips if the last flip is heads. It is the same as the distribution we had before shifted to the right. If you look carefully at the rectangles you'll see that both the even number of heads {0, 2, 4} are made up of 2 short and 2 long rectangles as are the odd number of heads {1, 3}.

The same pattern occurs for n = 20: we can think of it as two n = 19 distributions combined:



```{r, fig.width = 5}
df19 <- make_df(19)
df20H <- df19 %>% mutate(x4 = x + 1, last_flip = "H")
df20T <- df19 %>% mutate(x4 = x, last_flip = "T")
df20 <- rbind(df20H, df20T) %>% 
  mutate(last_flip = factor(last_flip, levels = c("T", "H"))) 

ggplot(df20, aes(x4, ways, fill = last_flip)) + geom_col() +
  ggtitle("Number of ways of getting X heads on 20 flips",
          sub = "shown as # of ways of getting X heads on 19 flips + 1 more flip")  + 
  scale_fill_manual(values = last_flip_colors) +
  xlab("number of heads")
```


If you look carefully you'll see that the rectangles for the even number of heads (Ben wins) match with the rectangles for the odd number of heads (Annie wins) and therefore the probability of Ben winning is 1/2.


